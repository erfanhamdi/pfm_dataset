Bootstrap: docker
From: dolfinx/dev-env:v0.8.0-openmpi
# for mpich 

%post
    # Ensure Ubuntu-like environment
    apt-get update
    apt-get install -y software-properties-common
    add-apt-repository ppa:fenics-packages/fenics
    apt update
    apt install fenicsx=v0.8.0

%environment
    export PATH=/usr/bin:$PATH
    export PYTHONUNBUFFERED=1

%runscript
    echo "Running DOLFINx dev-env in Singularity container"
    python3 -c "import dolfinx; print('DOLFINx version:', dolfinx.__version__)"

%labels
    Author Siamak
    Version 1.0
    Description "DOLFINx container with additional Ubuntu packages"

%test
    python3 -c "import dolfinx; print(dolfinx.__version__)"
